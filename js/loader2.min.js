/* SHOPINPIC.COM loader script
Thu May 14 16:31:45 MSK 2015
*/
(function(){function a(d){if(!d)throw Error("No options passed to Waypoint constructor");if(!d.element)throw Error("No element option passed to Waypoint constructor");if(!d.handler)throw Error("No handler option passed to Waypoint constructor");this.key="waypoint-"+b;this.options=a.Adapter.extend({},a.defaults,d);this.element=this.options.element;this.adapter=new a.Adapter(this.element);this.callback=d.handler;this.axis=this.options.horizontal?"horizontal":"vertical";this.enabled=this.options.enabled;
this.triggerPoint=null;this.group=a.Group.findOrCreate({name:this.options.group,axis:this.axis});this.context=a.Context.findOrCreateByElement(this.options.context);a.offsetAliases[this.options.offset]&&(this.options.offset=a.offsetAliases[this.options.offset]);this.group.add(this);this.context.add(this);c[this.key]=this;b+=1}var b=0,c={};a.prototype.queueTrigger=function(a){this.group.queueTrigger(this,a)};a.prototype.trigger=function(a){this.enabled&&this.callback&&this.callback.apply(this,a)};a.prototype.destroy=
function(){this.context.remove(this);this.group.remove(this);delete c[this.key]};a.prototype.disable=function(){this.enabled=!1;return this};a.prototype.enable=function(){this.context.refresh();this.enabled=!0;return this};a.prototype.next=function(){return this.group.next(this)};a.prototype.previous=function(){return this.group.previous(this)};a.invokeAll=function(a){var b=[],f;for(f in c)b.push(c[f]);f=0;for(var l=b.length;f<l;f++)b[f][a]()};a.destroyAll=function(){a.invokeAll("destroy")};a.disableAll=
function(){a.invokeAll("disable")};a.enableAll=function(){a.invokeAll("enable")};a.refreshAll=function(){a.Context.refreshAll()};a.viewportHeight=function(){return window.innerHeight||document.documentElement.clientHeight};a.viewportWidth=function(){return document.documentElement.clientWidth};a.adapters=[];a.defaults={context:window,continuous:!0,enabled:!0,group:"default",horizontal:!1,offset:0};a.offsetAliases={"bottom-in-view":function(){return this.context.innerHeight()-this.adapter.outerHeight()},
"right-in-view":function(){return this.context.innerWidth()-this.adapter.outerWidth()}};window.Waypoint=a})();
(function(){function a(a){window.setTimeout(a,1E3/60)}function b(a){this.element=a;this.Adapter=e.Adapter;this.adapter=new this.Adapter(a);this.key="waypoint-context-"+c;this.didResize=this.didScroll=!1;this.oldScroll={x:this.adapter.scrollLeft(),y:this.adapter.scrollTop()};this.waypoints={vertical:{},horizontal:{}};a.waypointContextKey=this.key;d[a.waypointContextKey]=this;c+=1;this.createThrottledScrollHandler();this.createThrottledResizeHandler()}var c=0,d={},e=window.Waypoint,f=window.onload;
b.prototype.add=function(a){this.waypoints[a.options.horizontal?"horizontal":"vertical"][a.key]=a;this.refresh()};b.prototype.checkEmpty=function(){var a=this.Adapter.isEmptyObject(this.waypoints.horizontal),b=this.Adapter.isEmptyObject(this.waypoints.vertical);a&&b&&(this.adapter.off(".waypoints"),delete d[this.key])};b.prototype.createThrottledResizeHandler=function(){function a(){b.handleResize();b.didResize=!1}var b=this;this.adapter.on("resize.waypoints",function(){b.didResize||(b.didResize=
!0,e.requestAnimationFrame(a))})};b.prototype.createThrottledScrollHandler=function(){function a(){b.handleScroll();b.didScroll=!1}var b=this;this.adapter.on("scroll.waypoints",function(){if(!b.didScroll||e.isTouch)b.didScroll=!0,e.requestAnimationFrame(a)})};b.prototype.handleResize=function(){e.Context.refreshAll()};b.prototype.handleScroll=function(){var a={},b={horizontal:{newScroll:this.adapter.scrollLeft(),oldScroll:this.oldScroll.x,forward:"right",backward:"left"},vertical:{newScroll:this.adapter.scrollTop(),
oldScroll:this.oldScroll.y,forward:"down",backward:"up"}},e;for(e in b){var f=b[e],c=f.newScroll>f.oldScroll?f.forward:f.backward,d;for(d in this.waypoints[e]){var m=this.waypoints[e][d],n=f.oldScroll<m.triggerPoint,p=f.newScroll>=m.triggerPoint,t=!n&&!p;if(n&&p||t)m.queueTrigger(c),a[m.group.id]=m.group}}for(var u in a)a[u].flushTriggers();this.oldScroll={x:b.horizontal.newScroll,y:b.vertical.newScroll}};b.prototype.innerHeight=function(){return this.element==this.element.window?e.viewportHeight():
this.adapter.innerHeight()};b.prototype.remove=function(a){delete this.waypoints[a.axis][a.key];this.checkEmpty()};b.prototype.innerWidth=function(){return this.element==this.element.window?e.viewportWidth():this.adapter.innerWidth()};b.prototype.destroy=function(){var a=[],b;for(b in this.waypoints)for(var f in this.waypoints[b])a.push(this.waypoints[b][f]);b=0;for(f=a.length;b<f;b++)a[b].destroy()};b.prototype.refresh=function(){var a=this.element==this.element.window,b=this.adapter.offset(),f=
{};this.handleScroll();var a={horizontal:{contextOffset:a?0:b.left,contextScroll:a?0:this.oldScroll.x,contextDimension:this.innerWidth(),oldScroll:this.oldScroll.x,forward:"right",backward:"left",offsetProp:"left"},vertical:{contextOffset:a?0:b.top,contextScroll:a?0:this.oldScroll.y,contextDimension:this.innerHeight(),oldScroll:this.oldScroll.y,forward:"down",backward:"up",offsetProp:"top"}},e;for(e in a){var b=a[e],c;for(c in this.waypoints[e]){var d=this.waypoints[e][c],m=d.options.offset,n=d.triggerPoint,
p=0,t=null==n;d.element!==d.element.window&&(p=d.adapter.offset()[b.offsetProp]);"function"===typeof m?m=m.apply(d):"string"===typeof m&&(m=parseFloat(m),-1<d.options.offset.indexOf("%")&&(m=Math.ceil(b.contextDimension*m/100)));d.triggerPoint=p+(b.contextScroll-b.contextOffset)-m;n=n<b.oldScroll;p=d.triggerPoint>=b.oldScroll;m=n&&p;n=!n&&!p;!t&&m?(d.queueTrigger(b.backward),f[d.group.id]=d.group):!t&&n?(d.queueTrigger(b.forward),f[d.group.id]=d.group):t&&b.oldScroll>=d.triggerPoint&&(d.queueTrigger(b.forward),
f[d.group.id]=d.group)}}for(var u in f)f[u].flushTriggers();return this};b.findOrCreateByElement=function(a){return b.findByElement(a)||new b(a)};b.refreshAll=function(){for(var a in d)d[a].refresh()};b.findByElement=function(a){return d[a.waypointContextKey]};window.onload=function(){f&&f();b.refreshAll()};e.requestAnimationFrame=function(b){(window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||a).call(window,b)};e.Context=b})();
(function(){function a(a,b){return a.triggerPoint-b.triggerPoint}function b(a,b){return b.triggerPoint-a.triggerPoint}function c(a){this.name=a.name;this.axis=a.axis;this.id=this.name+"-"+this.axis;this.waypoints=[];this.clearTriggerQueues();d[this.axis][this.name]=this}var d={vertical:{},horizontal:{}},e=window.Waypoint;c.prototype.add=function(a){this.waypoints.push(a)};c.prototype.clearTriggerQueues=function(){this.triggerQueues={up:[],down:[],left:[],right:[]}};c.prototype.flushTriggers=function(){for(var e in this.triggerQueues){var d=
this.triggerQueues[e];d.sort("up"===e||"left"===e?b:a);for(var c=0,h=d.length;c<h;c+=1){var k=d[c];(k.options.continuous||c===d.length-1)&&k.trigger([e])}}this.clearTriggerQueues()};c.prototype.next=function(b){this.waypoints.sort(a);b=e.Adapter.inArray(b,this.waypoints);return b===this.waypoints.length-1?null:this.waypoints[b+1]};c.prototype.previous=function(b){this.waypoints.sort(a);return(b=e.Adapter.inArray(b,this.waypoints))?this.waypoints[b-1]:null};c.prototype.queueTrigger=function(a,b){this.triggerQueues[b].push(a)};
c.prototype.remove=function(a){a=e.Adapter.inArray(a,this.waypoints);-1<a&&this.waypoints.splice(a,1)};c.prototype.first=function(){return this.waypoints[0]};c.prototype.last=function(){return this.waypoints[this.waypoints.length-1]};c.findOrCreate=function(a){return d[a.axis][a.name]||new c(a)};e.Group=c})();
(function(){function a(a){return a===a.window}function b(b){return a(b)?b:b.defaultView}function c(a){this.element=a;this.handlers={}}var d=window.Waypoint;c.prototype.innerHeight=function(){return a(this.element)?this.element.innerHeight:this.element.clientHeight};c.prototype.innerWidth=function(){return a(this.element)?this.element.innerWidth:this.element.clientWidth};c.prototype.off=function(a,b){function d(a,b,c){for(var e=0,f=b.length-1;e<f;e++){var g=b[e];c&&c!==g||a.removeEventListener(g)}}
var c=a.split("."),h=c[0],c=c[1],k=this.element;if(c&&this.handlers[c]&&h)d(k,this.handlers[c][h],b),this.handlers[c][h]=[];else if(h)for(var q in this.handlers)d(k,this.handlers[q][h]||[],b),this.handlers[q][h]=[];else if(c&&this.handlers[c]){for(var r in this.handlers[c])d(k,this.handlers[c][r],b);this.handlers[c]={}}};c.prototype.offset=function(){if(!this.element.ownerDocument)return null;var a=this.element.ownerDocument.documentElement,c=b(this.element.ownerDocument),d={top:0,left:0};this.element.getBoundingClientRect&&
(d=this.element.getBoundingClientRect());return{top:d.top+c.pageYOffset-a.clientTop,left:d.left+c.pageXOffset-a.clientLeft}};c.prototype.on=function(a,b){var c=a.split("."),d=c[0],c=c[1]||"__default",c=this.handlers[c]=this.handlers[c]||{};(c[d]=c[d]||[]).push(b);this.element.addEventListener(d,b)};c.prototype.outerHeight=function(b){var c=this.innerHeight();b&&!a(this.element)&&(b=window.getComputedStyle(this.element),c+=parseInt(b.marginTop,10),c+=parseInt(b.marginBottom,10));return c};c.prototype.outerWidth=
function(b){var c=this.innerWidth();b&&!a(this.element)&&(b=window.getComputedStyle(this.element),c+=parseInt(b.marginLeft,10),c+=parseInt(b.marginRight,10));return c};c.prototype.scrollLeft=function(){var a=b(this.element);return a?a.pageXOffset:this.element.scrollLeft};c.prototype.scrollTop=function(){var a=b(this.element);return a?a.pageYOffset:this.element.scrollTop};c.extend=function(){for(var a=Array.prototype.slice.call(arguments),b=1,c=a.length;b<c;b++){var d=a[0],h=a[b];if("object"===typeof d&&
"object"===typeof h){var k=void 0;for(k in h)h.hasOwnProperty(k)&&(d[k]=h[k])}}return a[0]};c.inArray=function(a,b,c){return null==b?-1:b.indexOf(a,c)};c.isEmptyObject=function(a){for(var b in a)return!1;return!0};d.adapters.push({name:"noframework",Adapter:c});d.Adapter=c})();var g_globalAreaMapOffset=0;function ShopinpicArea(a,b,c,d){var e=a.img;this.sinpImage=a;this.xScale=c;this.yScale=d;if(this.imgObj=e)this.imgOffset=null,this.data=b,this.areas=[],this.init(this.data)}ShopinpicArea.prototype.remove=function(){for(var a in this.areas)this.areas[a].parentNode.removeChild(this.areas[a]);this.areas=[]};ShopinpicArea.prototype.refresh=function(){this.remove();this.init(this.data)};
ShopinpicArea.prototype.init=function(a){this.imgOffset=this._getAbsolutePosition();this.areas=[];for(i in a)this._addArea(i,a[i])};
ShopinpicArea.prototype._getAbsolutePosition=function(a){a||(a=this.imgObj);var b=0,c=0;window.getComputedStyle&&(b=parseInt(window.getComputedStyle(a,null).getPropertyValue("padding-left")),c=parseInt(window.getComputedStyle(a,null).getPropertyValue("padding-top")));if(a.offsetParent){do b+=a.offsetLeft+a.clientLeft,c+=a.offsetTop+a.clientTop;while(a=a.offsetParent)}return{left:b,top:c}};
ShopinpicArea.prototype._addArea=function(a,b){g_globalAreaMapOffset++;var c=parseInt(this.imgObj.clientWidth);parseInt(this.imgObj.clientHeight);var d=document.createElement("div");this.areas.push(d);var e="areamap_"+g_globalAreaMapOffset;d.setAttribute("id",e);d.setAttribute("class","areamap");parseInt(this.xScale*b.x);window.getComputedStyle&&(window.getComputedStyle(this.imgObj,null).getPropertyValue("position"),parseInt(window.getComputedStyle(this.imgObj,null).getPropertyValue("padding-left")),
parseInt(window.getComputedStyle(this.imgObj,null).getPropertyValue("padding-top")),parseInt(window.getComputedStyle(this.imgObj,null).getPropertyValue("border-left-width")),parseInt(window.getComputedStyle(this.imgObj,null).getPropertyValue("border-top-width")));e=this.sinpImage.sip.getAbsoluteData(this.imgObj);d.style.left=parseInt(e.x+b.x*this.xScale)+"px";d.style.top=parseInt(e.y+b.y*this.yScale)+"px";e=parseInt(this.xScale*b.width);d.style.width=e+"px";e=parseInt(this.yScale*b.height);d.style.height=
e+"px";d.innerHTML="";d.divId=g_globalAreaMapOffset;this.imgObj.parentNode.insertBefore(d,this.imgObj.nextSibling);d.onclick=function(){var a=document.getElementById("areamap_"+this.divId+"_popup");a.style.display=a.style.display&&"none"!=a.style.display?"none":"block"};b.placement||(b.placement="middle_center");var e=this.xScale*(parseInt(b.width)-24/this.xScale),f=this.yScale*(parseInt(b.height)-24/this.yScale);"top_left"==b.placement&&(iconTop=iconLeft=0);"top_center"==b.placement&&(iconLeft=e/
2,iconTop=0);"top_right"==b.placement&&(iconLeft=e,iconTop=0);"middle_left"==b.placement&&(iconLeft=0,iconTop=f/2);"middle_center"==b.placement&&(iconLeft=e/2,iconTop=f/2);"middle_right"==b.placement&&(iconLeft=e,iconTop=f/2);"bottom_left"==b.placement&&(iconLeft=0,iconTop=f);"bottom_center"==b.placement&&(iconLeft=e/2,iconTop=f);"bottom_right"==b.placement&&(iconLeft=e,iconTop=f);iconLeft=parseInt(iconLeft);iconTop=parseInt(iconTop);d.shadowDiv=document.createElement("div");d.shadowDiv.setAttribute("class",
"shopinpic_shadow_icon areamap_shadow_number_"+g_globalAreaMapOffset);d.shadowDiv.style.left=iconLeft-6+"px";d.shadowDiv.style.top=iconTop-5+"px";d.appendChild(d.shadowDiv);e=document.createElement("div");b.theme||(b.theme="target");e.setAttribute("class","shopinpic_icon shopinpic_"+b.theme+" shopinpic_"+b.theme+"_"+g_globalAreaMapOffset);e.style.left=iconLeft+"px";e.style.top=iconTop+"px";d.appendChild(e);f=document.createElement("div");e="areamap_"+g_globalAreaMapOffset+"_popup";f.setAttribute("id",
e);b.showOnLoad&&(f.style.display="block");var l=b.color?b.color:"biege",g="";b.visible&&(g="areamap_visible");f.setAttribute("class","areamap_popup background_theme_"+l+" "+g);var l=parseInt(iconLeft+24+2),g=iconLeft-24+10-150,h="right",h="undefined"===typeof this.sinpImage.sip.popupPositioning?"right":this.sinpImage.sip.popupPositioning;"left"==h&&(l=g);"auto"==h&&(h=parseInt(d.style.marginLeft),h+iconLeft-2-150>c-(h+l+150)&&(l=g));f.style.left=l+"px";f.style.top=iconTop+"px";f.style.width="150px";
f.innerHTML="";b.title&&(f.innerHTML+='<div class="title">'+b.title+"</div>");b.alt&&(f.innerHTML+='<div class="text">'+b.alt+"</div>");b.popupHtml&&(f.innerHTML+=b.popupHtml);d.appendChild(f);c=parseInt(f.style.left);f.style.left="-10000px";f.style.display="block";parseInt(document.getElementById(e).clientHeight);f.style.left=c+"px";f.style.display="";f.style.opacity="";c=50+Math.floor(300*Math.random()+1);window.setTimeout(function(){d.setAttribute("class","areamap show")},c)};var ShopinpicImage=function(a){this.img=a;this.areas=[];this.controlPanelDiv=this.promoDiv=this.width=this.height=this.nHeight=this.nWidth=null};ShopinpicImage.prototype.refreshPromo=function(){if(this.promoDiv){var a=this.sip.getAbsoluteData(this.img);this.promoDiv.style.left=a.x+"px";this.promoDiv.style.top=a.y+a.h-12+"px";this.promoDiv.style.width=a.w+"px"}};
ShopinpicImage.prototype.addPromo=function(){this.promoDiv=document.createElement("div");this.promoDiv.setAttribute("class","sinp_promo");this.promoDiv.innerHTML='<span>Image mapping by <a href="http://shopinpic.com/" target="_blank">shopinpic.com</a><span>';this.img.parentNode.insertBefore(this.promoDiv,this.img.nextSibling);this.refreshPromo()};
ShopinpicImage.prototype.refreshControlPanel=function(){if(this.controlPanelDiv){var a=this.sip.getAbsoluteData(this.img);this.controlPanelDiv.style.width=a.w+"px";this.controlPanelDiv.style.left=a.x+"px";this.controlPanelDiv.style.top=a.y+a.h+"px"}};
ShopinpicImage.prototype.initControlPanel=function(){var a=document.createElement("ul");a.setAttribute("class","sinp_cp");a.innerHTML='<li><a href="#" onclick="window.open(\''+this.sip.baseUrl+"imgMap3/?apiKey="+this.sip.apiKey+"&url="+this.img.src+"&callback_url=', '_blank'); return false\">&nbsp;</a></li>";this.img.parentNode.insertBefore(a,this.img.nextSibling);this.controlPanelDiv=a;this.refreshControlPanel()};
ShopinpicImage.prototype.refreshAreas=function(){var a=this.img.width/this.nWidth,b=this.img.height/this.nHeight,c;for(c in this.areas)this.areas[c].xScale=a,this.areas[c].yScale=b,this.areas[c].refresh();this.refreshPromo();this.refreshControlPanel()};ShopinpicImage.prototype.highlightAreas=function(){for(var a in this.areas)for(var b in this.areas[a].areas)shopinpic_doHighlight(this.areas[a].areas[b].shadowDiv)};
function shopinpic_removeHighlight(a){var b=a.getAttribute("class"),b=b.replace("shadow_highlight","");a.setAttribute("class",b)}function shopinpic_doHighlight(a){var b=50+Math.floor(300*Math.random()+1);window.setTimeout(function(){var b=a.getAttribute("class");b.match(/shadow_highlight/)||(a.setAttribute("class",b+" shadow_highlight"),window.setTimeout(shopinpic_removeHighlight,250,a))},b)}
ShopinpicImage.prototype.initAreas=function(a){this.areas=[];a=new ShopinpicArea(this,a,this.img.width/this.nWidth,this.img.height/this.nHeight);this.areas.push(a);var b=this;this.sip.visibleAnimation&&new Waypoint({element:this.img,handler:function(a){b.highlightAreas()},offset:"80%"})};var Shopinpic=function(a){var b="https:"==document.location.protocol?"https://ssl.":"http://www.",c=document.createElement("script");c.src=b+"google-analytics.com/ga.js";c.onload=function(){var a=_gat._getTracker("UA-25646694-2");a._initData();a._trackPageview()};document.body.appendChild(c);this.baseUrl="//shopinpic.com/";"undefined"!==typeof a.baseUrl&&(this.baseUrl=a.baseUrl);this.visibleAnimation=!1;"undefined"!==typeof a.visibleAnimation&&(this.visibleAnimation=a.visibleAnimation);this.className=
null;"undefined"!==typeof a.className&&(this.className=a.imgCssName);this.adminMode=a.adminMode;this.minImageWidth=240;"undefined"!==typeof a.minImageWidth&&(this.minImageWidth=a.minImageWidth);this.minImageHeight=240;"undefined"!==typeof a.minImageHeight&&(this.minImageHeight=a.minImageHeight);this.apiKey=a.apiKey;this.popupPositioning=a.popupPositioning;this.sinpImages=[];var d=this;window.addEventListener?window.addEventListener("resize",function(a){d.onResize(a)}):window.attachEvent&&window.attachEvent("onresize",
function(a){d.onResize(a)});this.init()};document.getElementsByClassName||(document.getElementsByClassName=function(a){for(var b=[],c=this.getElementsByTagName("*"),d=0;d<c.length;d++)-1<(" "+c[d].className+" ").indexOf(" "+a+" ")&&b.push(c[d]);return b});Shopinpic.prototype.onResize=function(a){for(var b in sinp.sinpImages)this.sinpImages[b].refreshAreas()};
function getNaturalWidthHeight(a){var b={nWidth:null,nHeight:null};if(a.naturalWidth&&a.naturalHeight)b.nWidth=a.naturalWidth,b.nHeight=a.naturalHeight;else{var c=new Image;c.src=a.src;b.nWidth=c.width;b.nHeight=c.height;delete c}return b}
Shopinpic.prototype.init=function(){this.sinpImages=[];var a;a=this.className?document.getElementsByClassName(this.className):document.getElementsByTagName("img");var b=a.length;for(i=0;i<a.length;i++){var c=a[i],d=this;c.onerror=function(){b--;if(0==b)d.onInitialized()};c.onload=function(){var a=new ShopinpicImage(this);a.sip=d;var c=getNaturalWidthHeight(this);a.nWidth=c.nWidth;a.nHeight=c.nHeight;a.width=this.clientWidth;a.height=this.clientHeight;this.clientWidth>d.minImageWidth&&this.clientHeight>
d.minImageHeight&&d.sinpImages.push(a);b--;if(0==b)d.onInitialized()};if(1==c.complete)c.onload()}};Shopinpic.prototype.onInitialized=function(){var a=[],b;for(b in this.sinpImages)a.push(this.sinpImages[b].img.src);var c=this;this._getDatas(a,function(a){if(a.data)for(var b=0;b<a.data.length;b++){var f=a.data[b];c.sinpImages[f.id].addPromo();c.sinpImages[f.id].initAreas(f.areas)}});if(this.adminMode)for(b in this.sinpImages)this.sinpImages[b].initControlPanel()};
Shopinpic.prototype._getDatas=function(a,b){for(var c=this.baseUrl+"imgMap3/getDatas.php?apiKey="+this.apiKey,d="",e=0;e<a.length;e++)0<e&&(d+="&"),d+="imagesUrls[]="+a[e];if(d.length){var e=navigator.userAgent,f=99;1<e.indexOf("MSIE")&&(f=parseInt(e.substr(e.indexOf("MSIE")+5,5)));if(10>f){var l=new XDomainRequest;l&&(l.open("POST",c),l.onload=function(){var a=null;window.JSON&&window.JSON.parse?a=window.JSON.parse(l.responseText):eval("jsonObj = "+l.responseText);b(a)},l.send(d))}else{var g=this._createXMLHTTPObject();
g&&(g.open("POST",c,!0),d&&g.setRequestHeader("Content-type","application/x-www-form-urlencoded"),g.onreadystatechange=function(){if(4==g.readyState&&(200==g.status||304==g.status)){var a=null;window.JSON&&window.JSON.parse?a=window.JSON.parse(g.response):eval("jsonObj = "+trim(g.response));b(a)}},4!=g.readyState&&g.send(d))}}};
Shopinpic.prototype._createXMLHTTPObject=function(){this._XMLHttpFactories=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];for(var a=!1,b=0;b<this._XMLHttpFactories.length;b++){try{a=this._XMLHttpFactories[b]()}catch(c){continue}break}return a};
Shopinpic.prototype.getAbsoluteData=function(a){var b=0,c=0,d=0,e=0,d=a,f=0,l=0;do{var g=window.getComputedStyle(d);if("relative"!=g.getPropertyValue("position")){e=parseInt(g.getPropertyValue("padding-left"));isNaN(e)&&(e=0);var h=parseInt(g.getPropertyValue("padding-top"));isNaN(h)&&(h=0);var k=parseInt(g.getPropertyValue("border-left-width"));"thin"==k&&(k=2);"medium"==k&&(k=4);"thick"==k&&(k=6);isNaN(k)&&(k=0);g=parseInt(g.getPropertyValue("border-top-width"));"thin"==g&&(g=2);"medium"==g&&(g=
4);"thick"==g&&(g=6);isNaN(g)&&(g=0);var q=d.offsetLeft;isNaN(q)&&(q=0);var r=d.offsetTop;isNaN(r)&&(r=0);f+=e+2*k;l+=h+2*g;b+=parseInt(q)+k+e;c+=parseInt(r)+g+h}}while(d=d.offsetParent);d=b;e=c;b=Math.max(a.clientWidth,a.offsetWidth)-f;a=Math.max(a.clientHeight,a.offsetHeight)-l;return{x:d,y:e,w:b,h:a}};
Shopinpic_extendChildImages=function(a){if(a=document.getElementById(a)){a=a.getElementsByTagName("img");for(var b=0;b<a.length;b++){var c=a[b].getAttribute("class");if(!c||!c.match(/shopinpic/)){var d="shopinpic";c&&null!=c&&(d=c+" "+d);a[b].setAttribute("class",d)}}}};window.Shopinpic=Shopinpic;window.Shopinpic_extendChildImages=Shopinpic_extendChildImages;
window.getComputedStyle||(window.getComputedStyle=function(a,b){this.el=a;this.getPropertyValue=function(b){var d=/(\-([a-z]){1})/g;"float"==b&&(b="styleFloat");d.test(b)&&(b=b.replace(d,function(a,b,c){return c.toUpperCase()}));return a.currentStyle[b]?a.currentStyle[b]:null};return this});
